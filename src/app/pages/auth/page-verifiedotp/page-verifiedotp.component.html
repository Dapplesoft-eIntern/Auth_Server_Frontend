<p-toast></p-toast>

<div class="flex h-screen items-center justify-center bg-gray-100">
    <div class="w-full max-w-md rounded bg-white p-10 shadow-xl">

        <h2 class="text-xl font-bold text-gray-800">Verification Code</h2>

        <p class="mt-2 text-sm text-gray-500">
            Enter the 4-digit code sent to your
            {{ otpStateService.getState().method }}.
        </p>

        <!-- TIMER -->
        <p
            class="mt-3 text-sm font-medium text-blue-600"
            *ngIf="otpStateService.getState().timeRemaining > 0">
            Time remaining: {{ otpStateService.getFormattedTime() }}
        </p>

        <!-- EXPIRED -->
        <p-message
            *ngIf="otpStateService.getState().verificationStatus === 'expired'"
            severity="error"
            variant="simple"
            class="mt-2">
            OTP expired. Please resend.
        </p-message>

        <!-- OTP INPUT -->
        <div class="mt-6 flex justify-center">
            <p-inputotp
                [formControl]="otpControl"
                [length]="4"
                inputStyleClass="w-12 h-12 text-lg text-center">
            </p-inputotp>
        </div>

        <!-- SUBMIT -->
        <button
            pButton
            class="mt-6 w-full bg-blue-500 py-2 font-bold text-white"
            (click)="onSubmit()"
            [disabled]="loading || !otpStateService.isOtpValid()">
            {{ loading ? 'Verifying...' : 'Verify OTP' }}
        </button>

        <!-- RESEND -->
        <div class="mt-6 text-center">
            <button
                class="text-sm font-semibold text-blue-600"
                [disabled]="loading || otpStateService.isOtpValid()"
                (click)="resendOtp()">
                Resend OTP
            </button>
        </div>

    </div>
</div>
