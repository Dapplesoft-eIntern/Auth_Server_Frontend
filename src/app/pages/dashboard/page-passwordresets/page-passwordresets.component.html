<div class="min-h-screen p-5 pt-20 text-black">
  <h2 class="text-2xl font-bold mb-4 text-gray-800">Password Reset Tokens</h2>


  <div class="bg-white border border-gray-300 rounded shadow overflow-hidden">
    <p-table [value]="resetTokens" [paginator]="true" [rows]="10" class="p-datatable-striped p-datatable-gridlines">

      <ng-template pTemplate="header">
        <tr class="bg-gray-800 text-white">
          <th>ID</th>
          <th>User</th>
          <th>Token</th>
          <th>Expires At</th>
          <th>Used</th>
          <th>Action</th>
        </tr>
      </ng-template>

      <ng-template pTemplate="body" let-token>
        <tr class="hover:bg-gray-50 transition">
          <td>{{ token.id }}</td>
          <td>{{ token.user_name }}</td>
          <td class="truncate max-w-xs">{{ token.token }}</td>
          <td>{{ token.expires_at }}</td>
          <td>
            <p-tag [severity]="token.used ? 'success' : 'danger'" [value]="token.used ? 'Used' : 'Not Used'"></p-tag>
          </td>
          <td>
            <button pButton type="button" class="p-button-sm p-button-info mr-2"
              (click)="openEditDialog(token)">Edit</button>
            <button pButton type="button" class="p-button-sm p-button-danger"
              (click)="deleteToken(token)">Delete</button>
          </td>
        </tr>
      </ng-template>

    </p-table>
  </div>

  <p-dialog header="{{ isAddMode ? 'Add Password Token' : 'Edit Password Token' }}" [(visible)]="dialogVisible"
    [modal]="true" [style]="{width:'400px'}" [closable]="false" [draggable]="false">

    <div class="p-fluid space-y-4">

      <div class="p-field flex flex-col">
        <label class="text-gray-700 font-semibold mb-1">User Name</label>
        <input pInputText [(ngModel)]="editingToken.user_name"
          class="p-inputtext p-component border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
          placeholder="Enter user name" />
      </div>

      <div class="p-field flex flex-col">
        <label class="text-gray-700 font-semibold mb-1">Token</label>
        <input pInputText [(ngModel)]="editingToken.token"
          class="p-inputtext p-component border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
          placeholder="Enter token" />
      </div>


      <div class="p-field flex flex-col">
        <label class="text-gray-700 font-semibold mb-1">Expires At</label>
        <input pInputText [(ngModel)]="editingToken.expires_at"
          class="p-inputtext p-component border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
          placeholder="YYYY-MM-DD HH:MM" />
      </div>

      
      <div class="p-field flex flex-col">
        <label class="text-gray-700 font-semibold mb-1">Used</label>
        <select [(ngModel)]="editingToken.used"
          class="p-inputtext p-component border border-gray-300 rounded-lg p-2 focus:outline-none focus:ring-2 focus:ring-blue-400">
          <option [ngValue]="true">Used</option>
          <option [ngValue]="false">Not Used</option>
        </select>
      </div>
    </div>


    <ng-template pTemplate="footer">
      <button pButton type="button" label="Cancel" class="p-button-secondary mr-2"
        (click)="dialogVisible=false"></button>
      <button pButton type="button" label="Save" class="p-button-success" (click)="saveToken()"></button>
    </ng-template>

  </p-dialog>


  <p-toast></p-toast>
  <p-confirmDialog></p-confirmDialog>
</div>